{$head}
</head>
<body xmlns="http://www.w3.org/1999/html">
<div class="wrap js-check-wrap">
    <ul class="nav nav-tabs">
        <li class="active"><a href="{$url_list}">{$list_name}</a></li>

        <if condition="isset($index_add)">
            {$menu_add}
            <li><a href="{$url_add}">添加</a></li>
            {$end_if}
        </if>

    </ul>

    <form class="well form-inline margin-top-20 layui-form ajax-form w-form-search" method="get" autocomplete="off">
        关键字：
        <div class="form-group layui-form">
            <div class="layui-form-item" style="margin-bottom: 0 !important;">
                <div class="col-md-12">
                    <div class="layui-inline">
                        <input type="text" class="form-control" name="keyword" style="width: 180px;"
                               value="{$name}" placeholder="请输关键字搜索">
                    </div>
                </div>
            </div>
        </div>

        <button type="submit" class="layui-btn" style="margin-left: 10px">搜索</button>
        <a class="layui-btn layui-bg-red" href="{$url_list}">清空</a>


        <if condition="isset($index_enter)">
            <a style="text-decoration:none;" class="layui-btn layui-bg-orange"
               href="javascript:parent.openIframeLayer('{$import}','导入',{ area: ['65%', '85%'],move:'.layui-layer-title'},false);">
                导入
            </a>
        </if>

<!--        <a class="layui-btn layui-bg-blue ajax-export" href="javascript:;">导出</a>-->

        <!-- 如有导出需把  筛选条件在这里用input回显,input需隐藏-->
        <input type="hidden" name="is_export" class="is_export" value="0">
        <input type="hidden" name="pid" value="{$pid}">
    </form>


    <form class="js-ajax-form" method="post" autocomplete="off">

        <br>
        <div class="table-actions">

            <if condition="isset($index_delete_s)">
                {$menu_delete}
                <button class="layui-btn layui-btn-primary layui-border-red layui-btn-xs js-ajax-submit"
                        data-action="{$url_delete_all}"
                        data-subcheck="true" data-msg="你确定删除吗？">删除
                </button>
                {$end_if}
            </if>

            <if condition="isset($index_recommend)">
                {$menu_recommend}
                <button class="layui-btn layui-btn-primary layui-border-blue layui-btn-xs js-ajax-submit" type="submit"
                        data-action="{$recommend_post}"
                        data-subcheck="true" data-msg="你确定设为推荐吗？">推荐
                </button>

                <button class="layui-btn layui-btn-primary layui-border-orange layui-btn-xs js-ajax-submit"
                        type="submit" data-action="{$no_recommend_post}"
                        data-subcheck="true" data-msg="你确定取消推荐吗？">取消推荐
                </button>
                {$end_if}
            </if>


            <if condition="isset($index_list_order)">
                {$menu_list_order}
                <button class="layui-btn layui-btn-primary layui-border-green layui-btn-xs js-ajax-submit" type="submit"
                        data-action="{$list_order_post}">
                    排序
                </button>
                {$end_if}
            </if>


        </div>


        <table class="table table-hover table-bordered">
            <thead>
            <tr>
                <if condition="isset($index_recommend) || isset($index_delete_s)">
                    {$menu_recommend}
                    <th style="">
                        <label>
                            <input type="checkbox" class="js-check-all" data-direction="x" data-checklist="js-check-x">
                        </label>
                    </th>
                    {$end_if}
                </if>

                <if condition="isset($index_list_order)">
                    {$menu_list_order}
                    <th style="">排序</th>
                    {$end_if}
                </if>


                <foreach name="fields" item="vo">
                    <th style="">{$vo.COLUMN_COMMENT}</th>
                </foreach>

                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            {$foreach}
            <tr>
                <if condition="isset($index_recommend) || isset($index_delete_s)">
                    {$menu_recommend}
                    <td>
                        <input type="checkbox" class="js-check post-params" data-yid="js-check-y" data-xid="js-check-x"
                               name="ids[]"
                               value="{$id}">
                    </td>
                    {$end_if}
                </if>


                <if condition="isset($index_list_order)">
                    {$menu_list_order}
                    <td style="width: 90px;">
                        <input style="width: 100%;!important;" type="number" min="1" class="form-control input input-order valid post-params" name="{$name_list_order}"
                               value="{$value_list_order}">
                    </td>
                    {$end_if}
                </if>


                <foreach name="fields" item="v">
                    <td>{$v.index_html}</td>  <if condition="isset($v.annotation_field_index) && $v.annotation_field_index">{$v.annotation_field_index}</if>
                </foreach>

                <td>
                    <if condition="isset($index_edit)">
                        {$menu_edit}
                        <a class="layui-btn layui-btn-primary layui-border-green layui-btn-xs" href="{$url_edit}">编辑</a>
                        {$end_if}
                    </if>

                    <if condition="isset($index_edit)">
                        <div style="display: none;">
                            {$menu_edit}
                            <a class="layui-btn layui-btn-primary layui-border-green layui-btn-xs"
                               href="javascript:parent.openIframeLayer('{$url_edit}','编辑',{ area: ['65%', '85%'],move:'.layui-layer-title'},true);"
                            >编辑(弹框-更改后台方法,跳转页面)</a>
                            {$end_if}
                        </div>
                    </if>

                    <if condition="isset($index_find)">
                        {$menu_find}
                        <a class="layui-btn layui-btn-primary layui-border-blue layui-btn-xs"
                           href="javascript:parent.openIframeLayer('{$find_id}','查看',{ area: ['65%', '85%'],move:'.layui-layer-title'},false);"
                        >查看</a>
                        {$end_if}
                    </if>


                    <if condition="isset($index_delete)">
                        {$menu_delete}
                        {$url_delete}
                        {$end_if}
                    </if>


                </td>
            </tr>
            {$foreachEnd}
            </tbody>
        </table>
    </form>

    {$pagination}
</div>
<script src="{$admin_js}"></script>
</body>
</html>


<!--修改状态|导出|搜索  js代码-->
<script>

    //开关板块
    layui.use(['layer', 'form', 'slider'], function () {
        var layer = layui.layer, form = layui.form;


        {$index_checkbox_js}


    });

    //修改状态
    function batchPost(id, field, value) {
        $.ajax({
            url: "{$batch_post}",
            type: "POST",
            data: {id: id, [field]: value},
            success: function (res) {
                if (res.code === 1) {
                    layer.msg(res.msg, {icon: 1});

                    //默认关闭刷新页面
                    // let time1 = setInterval(function () {
                    //     //页面自动刷新
                    //     location.reload();
                    // }, 500);
                } else {
                    layer.msg(res.msg, {icon: 7});
                }
            }
        });
    }


    //导出
    $(".ajax-export").click(function () {
        //alert("正在开发中...");
        $(".is_export").val(1);
        $(".ajax-form").submit();
        $(".is_export").val(0);
        return false;
    });

    //搜索
    $(".bt_search").click(function () {
        $(".w-form-search").removeAttr('action');
        $(".w-form-search").attr('action', "{:url('index')}");
        $(".w-form-search").submit();
    });
</script>

